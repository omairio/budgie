<!DOCTYPE html>
<html>

<head>

  <%= javascript_include_tag "//www.google.com/jsapi", "chartkick" %>
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
  <title>Budgie</title>
  <%= stylesheet_link_tag    "application", media: "all", "data-turbolinks-track" => true %>
  <%= javascript_include_tag "application", "data-turbolinks-track" => true %>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
  <%= csrf_meta_tags %>
</head>

<body>
	<% if signed_in? %>
 
  <div id="login_status">
    <%= render 'shared/login_message' %>
  </div>
  
<!--Header-->
<div id="header" class="navbar navbar-default">

    <!--Login Greeting-->
  <div class="container">
    <div class="float-left">
      <a href="/"><%= image_tag("logo_small.png", :alt => "budgie_logo") %></a>
    </div>
    <div class="float-right"><%= link_to raw('<button class="btn btn-primary btn-large" role="button">Sign Out</button>'), signout_path, method: "delete" %></div>

    </div>
  </div>

  <!-- Begin page content -->
  <div class="center-container">
    <div class="center-row">
      

        <!--LEFT SIDE-->

        <% @total = get_total %>

        <% if @total < 0 %>
          <div class="col-xs-6 left" style="background: url('<%= asset_path 'sunset1.jpg' %>');">
        <% elsif @total >= 0 and @total < 500 %>
          <div class="col-xs-6 left" style="background: url('<%= asset_path 'sunset2.jpg' %>');">
        <% elsif @total >= 500  and @total < 1000 %>
          <div class="col-xs-6 left" style="background: url('<%= asset_path 'sunset3.jpg' %>');">
        <% elsif @total >= 1000 %>
          <div class="col-xs-6 left" style="background: url('<%= asset_path 'sunset4.jpg' %>');">
        <% else %>
          <div class="col-xs-6 left" style="background: url('<%= asset_path 'sunset1.jpg' %>');">
        <% end %>

       <!--  <p>You have spent</p>
        <h1>59%</h1>
        <p>of your previous month's expenditure.</p> -->
        <p>You have saved</p>
        <h1><%= sprintf("%.2f", @total) %></h1>
         <p>
          <% if current_user.date_type == "Day" %>
          <% if (current_user.date == Date.today) %>
          today
          <% else %>
          on <%= current_user.date %>
          <% end %>
          <% elsif current_user.date_type == "Week" %>
          <p>this week</p>
          <% elsif current_user.date_type == "Month" %>
          <% if (current_user.date.month == Date.today.month and current_user.date.year == Date.today.year) %>
          this month
          <% else %>
          during <%= Date::MONTHNAMES[current_user.date.month] %> <%= current_user.date.year %>
          <% end %>
          <% elsif current_user.date_type == "Year" %>

          <% if (current_user.date.year == Date.today.year) %>
          this year
          <% else %>
          during <%= current_user.date.year %>
          <% end %>

          <% elsif current_user.date_type == "All" %>
          <p>overall</p>
          <% else %>
          <p>today</p>
          <% end %>
        </p>


<script>
          Highcharts.setOptions({
            chart: {
              style: {
                fontFamily: 'serif'
              }
            }
          });
          $(function () {
            $('#container').highcharts({
              chart: {
               backgroundColor: 'rgba(255, 255, 255, 0.2)'
              },
              title: {
                <% if (current_user.date_type == "Day") %>
                text: 'Daily Spending'
                <% elsif (current_user.date_type == "Week") %>
                text: 'Weekly Spending'
                <% elsif (current_user.date_type == "Month") %>
                text: 'Monthly Spending'
                <% elsif (current_user.date_type == "Year") %>
                text: 'Yearly Spending'
                <% elsif (current_user.date_type == "All") %>
                text: 'Overall Spending'
                <% end %>
                ,
           //center
          },
          subtitle: {

            x: -20
          },
          xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
            'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
          },
          yAxis: {
            title: {
              text: 'Temperature (°C)'
            },
            plotLines: [{
              value: 0,
              width: 1,
              color: '#808080'
            }]
          },
          tooltip: {
            valueSuffix: '°C'
          },
          legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
          },
          series: [{
            name: 'Poop',
            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
          }, {
            name: 'Vehicle',
            data: [-0.2, 0.8, 5.7, 11.3, 17.0, 22.0, 24.8, 24.1, 20.1, 14.1, 8.6, 2.5]
          }, {
            name: 'Onions',
            data: [-0.9, 0.6, 3.5, 8.4, 13.5, 17.0, 18.6, 17.9, 14.3, 9.0, 3.9, 1.0]
          }, {
            name: 'Food',
            data: [3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
          }]
        });
});
</script>

<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

      </div>

      <!--RIGHT SIDE-->
      <div class="col-xs-6 right">

        <div class="btn-group-vertical float-left" id="icons">

          <div>
            <%= link_to raw('<button type="button" class="btn btn-large btn-lg"><span class="glyphicon glyphicon-plus"></span></button>'), new_transaction_path, method: "get" %>
          </div>
          
          <div>
            <%= link_to raw('<button type="button" class="btn btn-large btn-lg"><span class="glyphicon glyphicon-cog"></span></button>'), myaccount_path, method: "get" %>
          </div>

        </div>

        <%= yield %>

      </div>
    </div>
  </div>
  <% else %>

  <%= yield %>

  <% end %>
  <div id="footer">
   <div class="container" id="debug">
    <%= params.inspect %>
  </div>
</div>
</body>
</html>
